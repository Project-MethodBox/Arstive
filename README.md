# Arstive
音乐游戏**Arstive**原型机，非游戏引擎开发，
运行于Windows平台，依赖.Net8.0框架，以
Windows Presentation Foundation为技术栈
进行开发。

## 简介
Arstive是以几何为特色的创新性下落式音游，判定依靠异形判定线“判定角”来进行，包含三种下落式音符Tap、Hold与Drag，以及一种自由音符（目前）Move，该音符给出两个按键，玩家应该在限定时间内由头部按键以随意路径滑动至尾部按键。<br/>
开发基于传统的三层模型，数据使用Json格式存储，但是方便起见直接将读取方法写在Chart加载类里导致了DAL和BLL产生了严重的合并（逃走）UI层使用MVC模型，主窗口分数等信息直接以数据绑定（单向）的方式绑定在相应静态类上。

## 运行原理
本音游原型基于WPF开发，其底层运用DirectX引擎进行相应渲染。
<br/>
主要运作流程使用多线程技术进行管理，其中n个线程管理其中的每个判定角进行下落式音符的判定，1个线程进行计时器的维护，1个线程用于Move音符的判定，一个现场进行音频的播放，以上线程在运行之前均使用一个Barrier阻塞，当所有线程均加载完毕后，Barrier被释放，游戏开始。<br/>
也就是说，每个判定角线程以10毫秒为周期震荡，并维护如下过程：
- 读取Note，计算该Note的下落时长并通过创建**ThicknessAnimation**进行Note下落动画的展示。
- 计算当前判定列表中最近的（三）个Note的判定时间与当前时间的差值，并根据按键状态进行对应的判定（非游戏引擎下的高效触控系统的打造详见后文），并对分数进行操作。
- 查找最近的几个判定角动画，并创建**ThicknessAnimation**或**DoubleAnimation**进行判定线动画的播放。

重复以上过程直到动画列表、Note列表均为空，此时线程积极触发Barrier，线程堵塞和挂起，直到所有线程均挂起，游戏结束。

## 相应实现
- **时钟系统**
